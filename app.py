import streamlit as st
import pickle
from pythainlp.tokenize import word_tokenize

# р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Др╕│р╣Др╕бр╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б (р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З)
bad_words = [
    "р╣Ар╕лр╕╡р╣Йр╕в",
    "р╕кр╕▒р╕к",
    "р╣Ар╕вр╣Зр╕Фр╣Бр╕бр╣И",
        "р╣Ар╕вр╣Йр╕Фр╣Бр╕бр╣И",
        "р╣Др╕нр╣Й",
        "р╣Др╕н",
        "р╕лр╣Ир╕▓р╕бр╕╢р╕З","р╕нр╕╡р╕Фр╕нр╕Б","р╕Юр╣Ир╕нр╕бр╕╢р╕Зр╕нр╣Ир╕░","р╕Др╕зр╕▓р╕в","р╣Др╕нр╣Йр╣Ар╕нр╣Лр╕н","р╣Бр╕бр╣Ир╕бр╕╢р╕Зр╕Хр╕▓р╕в","р╕Ыр╕▒р╕Нр╕Нр╕▓р╕нр╣Ир╕нр╕Щ","р╣Ар╕лр╕╡р╣Йр╕вр╣Др╕г" ,"р╕Др╕зр╕вр╣Др╕г","р╕Юр╣Ир╕нр╕бр╕╢р╕Зр╕нр╣Ир╕░","р╕нр╕╡р╕кр╕▒р╕к","р╕лр╕Щр╣Йр╕▓р╕лр╕╡","р╕лр╕Щр╣Йр╕▓р╣Ар╕лр╕╡р╣Йр╕в","р╕кр╕▒р╕Щр╕Фр╕▓р╕Щр╕лр╕бр╕▓","р╕Чр╕╕р╣Ар╕гр╕и","р╕кр╕Цр╕╕р╕Щ","р╣Др╕бр╣Ир╕бр╕╡р╕Ыр╕▒р╕Нр╕Нр╕▓р╕лр╕▓р╕Вр╣Йр╕▓р╕зр╣Бр╕Фр╕Бр╕лр╕гр╕н",
    "р╕нр╕╡р╣Ар╕лр╕╡р╣Йр╕в","р╣Ар╕ор╕Зр╕Лр╕зр╕в","р╕Др╕зр╕в","р╕лр╕Щр╣Йр╕▓р╕Ьр╕╡","р╕нр╕╡р╣Ар╕Ыр╕гр╕Х","р╕Фр╕нр╕Бр╕Чр╕нр╕З","р╣Бр╕Фр╕Б" ,"р╣Ар╕кр╕╖р╕нр╕Б","р╕Ър╕▒р╕Фр╕Лр╕Ъ","р╣Ар╕зр╕г","р╣Ар╕Кр╕╡р╣Ир╕в","р╕бр╕▓р╕гр╕ир╕▓р╕кр╕Щр╕▓","р╕кр╕░р╣Ар╕нр╕нр╕░","р╕кр╕▓р╕гр╕░р╣Бр╕Щ","р╕Ьр╕╣р╣Йр╕лр╕Нр╕┤р╕Зр╕Хр╣Ир╕│р╣Ж","р╕нр╕╡р╕гр╣Йр╕нр╕вр╕Др╕зр╕в"
]

model = pickle.load(open("model.pkl", "rb"))
vectorizer = pickle.load(open("vectorizer.pkl", "rb"))

def preprocess(text):
    return " ".join(word_tokenize(text, engine="newmm"))

st.title("ЁЯза AI р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╕Др╕│р╕лр╕вр╕▓р╕Ър╣Гр╕Щр╣Бр╕Кр╕Х")

text = st.text_area("р╕Юр╕┤р╕бр╕Юр╣Мр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ")


if st.button("р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ"):
    t = preprocess(text)
    words = t.split()

    # р╕Хр╕гр╕зр╕Ир╕Др╕│р╕лр╕вр╕▓р╕Ър╕Ир╕▓р╕Бр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Бр╣Ир╕нр╕Щ
    for w in bad_words:
        if w in words:
            st.error("ЁЯФ┤ р╕Юр╕Ър╕Др╕│р╕лр╕вр╕▓р╕Ър╣Гр╕Щр╕Ыр╕гр╕░р╣Вр╕вр╕Д")
            st.stop()

    # р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Ар╕Ир╕нр╕Др╕│р╕лр╕вр╕▓р╕Ър╣Гр╕Щр╕ер╕┤р╕кр╕Хр╣М тЖТ р╣Гр╕лр╣Й AI р╕Хр╕гр╕зр╕И
    x = vectorizer.transform([t])
    result = model.predict(x)[0]

    if result == 1:
        st.error("ЁЯФ┤ р╕Юр╕Ър╕Др╕│р╕лр╕вр╕▓р╕Ъ")
    else:
        st.success("ЁЯЯв р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕кр╕╕р╕ар╕▓р╕Ю")


